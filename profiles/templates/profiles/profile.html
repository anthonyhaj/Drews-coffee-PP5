{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container">
    <div class="row">
        <!-- User Information Section -->
        <div class="col-md-6">
            <h2 class="mb-4">User Profile</h2>
            <p class="text-muted">Default Delivery Information</p>
            <!-- User Profile Update Form -->
            <form class="mt-3" action="{% url 'profile' %}" method="POST" id="profile-update-form">
                {% csrf_token %}
                {{ form|crispy }}
                <button class="btn btn-primary">Update Information</button>
            </form>
        </div>

        <!-- Order History Section -->
        <div class="col-md-6">
            <h2 class="mb-4">Order History</h2>
            {% for order in user_orders %}
            <div class="card mb-3">
                <div class="card-header">
                    <strong>Order ID:</strong> {{ order.id }}<br>
                    <strong>Date:</strong> {{ order.date|date:"d M Y" }}
                </div>
                <div class="card-body">
                    {% for item in order.lineitems.all %}
                    <div class="row align-items-center mb-2">
                        <div class="col-2">
                            <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                                class="img-fluid rounded" style="max-width: 50px;">
                        </div>
                        <div class="col-6 col-md-4">
                            <p class="mb-0 text-black font-weight-bold">{{ item.product.name }}</p>
                        </div>
                        <div class="col-4 col-md-6 text-md-right">
                            <p class="mb-0">Quantity: {{ item.quantity }} <br>
                                â‚¬{{ item.product.price }}
                                {% if item.product_size %}
                                <br> - Size {{ item.product_size|upper }}
                                {% endif %}
                            </p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}


{% block postloadjs %}
{{ block.super }}
<script src="{% static 'profiles/js/country_field.js' %}"></script>
{% endblock %}